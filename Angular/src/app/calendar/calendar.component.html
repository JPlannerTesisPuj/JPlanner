<div *ngIf="showLoader" class="dispclass-loader updating-size"></div>
<div *ngIf="isMobile" class="col-12 cal-display-sm lg-hidden md-hidden cal-alt-mobile">
  <div class="cal-alternatives-paginator ">
    <div class="cal-alt-title-div">
      <input [(ngModel)]="alternativeTitles[currentAlternative]" class="atom-alternative-input-field" id="cal-alt-title"
        maxlength="25" name="Alternative Title" type="text"></div>
    <div class="cal-alt-radio-group">
      <label *ngFor='let ind of alternativeIterationArray ' class="cal-radio-container">
        <input (change)="onItemChange(ind)" [(ngModel)]="currentAlternative" [value]="ind" name="cal-alternative"
          type="radio">
        <span class="atom-radio-btn"></span>
      </label>
    </div>
  </div>
</div>
<div class="cal-menu-container col-3_xs-12_sm-12_md-12_lg-3 sm-hidden">
  <!--
    verticalMenuIndex es una variable numérica del componente que le indica al menú
    qué pestaña debe seleccionar. Así mismo, el menú le indica el número de la pestaña
    que el usuario seleccione. El primer index del menú comienza en 0.
  -->
  <mat-tab-group [(selectedIndex)]="verticalMenuIndex">
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          search
        </i>
      </ng-template>
      <app-filter></app-filter>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          view_list
        </i>
      </ng-template>
      <app-display-subjects (addSubjetEmit)="addClassSubject($event)" [calendarBlocks]="calendarBlocks"
        [calendarList]="calendarList"></app-display-subjects>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          shopping_cart
        </i>
      </ng-template>
      <app-shopping-cart (removeSubject)="removeClass($event)" [altTitle]='alternativeTitles[currentAlternative]'
        [classes]='alternativeCalendarClasses[currentAlternative]'></app-shopping-cart>
    </mat-tab>
  </mat-tab-group>
</div>
<div class="cal-schedule-container col-9_xs-12_sm-12_md-12_lg-9 sm-hidden">
  <div *ngIf="!isMobile" class="cal-alternatives-paginator sm-hidden xs-hidden">
    <div class="cal-alt-title-div">
      <input [(ngModel)]="alternativeTitles[currentAlternative]" class="atom-alternative-input-field" id="cal-alt-title"
        maxlength="25" name="Alternative Title" type="text"></div>
    <div class="cal-alt-radio-group">
      <label *ngFor='let ind of alternativeIterationArray ' class="cal-radio-container">
        <input (change)="onItemChange(ind)" [(ngModel)]="currentAlternative" [value]="ind" name="cal-alternative"
          type="radio">
        <span class="atom-radio-btn"></span>
      </label>
    </div>
    <div class="cal-alt-number-credits">
      <label>Número de Créditos:
        <label class="number-credits">{{creditCounter[currentAlternative]}}</label>
      </label>
    </div>
    <div class="checkbox-atom-fix-div">
      <label class="checkbox-atom-container checkbox-atom-fix" for="editBlockOption">
        Eliminar/Editar bloqueo semanalmente
        <input [(ngModel)]="editBlockOption" class="hidden-checkbox" id="editBlockOption" name="editBlockOption"
          type="checkbox">
        <span class="checkbox-atom"></span>
      </label>
    </div>
  </div>
  <div *ngIf="sholudDisplayDialog[currentAlternative]" class="cal-conflict-msj">
    <span>
      ¡Conflicto!</span>
    <i class="material-icons">warning</i>
  </div>
  <!--
    Los pasos para personalizar el Calendario fueron tomados de aquí https://github.com/mattlewis92/angular-calendar#how-do-i-use-a-custom-template
    La diferencia entre esta plantilla y la plantilla por defecto es que en esta no se muestra la fecha del día, sólo el nombre.
  -->
  <!--INICIO PLANTILLAS PERSONALIZADAS -->
  <ng-template #customWeekViewHourSegmentTemplateJplanner let-isTimeLabel="isTimeLabel" let-locale="locale"
    let-segment="segment" let-segmentHeight="segmentHeight">
    <div #segmentElement (mousedown)="startDragToCreateBlock(segment, $event, segmentElement)"
      [class.cal-hour-start]="segment.isStart" [ngClass]="segment.cssClass" [style.height.px]="segmentHeight"
      class="cal-hour-segment">
      <div *ngIf="isTimeLabel" class="cal-time">
        {{ segment.date | date:'H:mm':locale }}
      </div>
    </div>
  </ng-template>
  <ng-template #customDayViewHourSegmentTemplateJplanner let-isTimeLabel="isTimeLabel" let-locale="locale"
    let-segment="segment" let-segmentHeight="segmentHeight">
    <div #segmentElementDay (touchstart)="startDragToCreateBlock(segment, $event, segmentElementDay)"
      [class.cal-hour-start]="segment.isStart" [ngClass]="segment.cssClass" [style.height.px]="segmentHeight"
      class="cal-hour-segment">
      <div class="cal-time">
        {{ segment.date | date:'H:mm':locale }}
      </div>
    </div>
  </ng-template>
  <!--FIN PLANTILLAS PERSONALIZADAS -->
  <br />
  <!--
    Los atributos de las vistas que cambiaron fueron:
    * hourSegments: de 2 a 1
    * dayStartHour: de 0 a 7
    * dayEndHour: de 23 a 22
  -->
  <div #calendarList="cdkDropList" (cdkDropListDropped)="dropClass($event)" cdkDropList
    class="cal-view-container grid-noGutter cal-view-desktop">
    <div class="btn-group cal-arrow-buttons-desktop">
      <button (viewDateChange)="activeDayIsOpen = false" [(viewDate)]="viewDate" [view]="view"
        class="btn btn-primary cal-buttons-weekend-left" mwlCalendarPreviousView></button>
      <button (viewDateChange)="activeDayIsOpen = false" [(viewDate)]="viewDate" [view]="view"
        class="btn btn-primary cal-buttons-weekend-right" mwlCalendarNextView></button>
    </div>
    <mwl-calendar-week-view (eventClicked)="handleEvent('Clicked', $event.event)"
      (eventTimesChanged)="eventTimesChanged($event)" [dayEndHour]="22" [dayStartHour]="7" [events]="classes"
      [hourSegmentHeight]="35" [hourSegmentTemplate]="customWeekViewHourSegmentTemplateJplanner" [hourSegments]="1"
      [locale]="locale" [refresh]="refresh" [viewDate]="viewDate" class="cal-display-lg sm-hidden col-12">
    </mwl-calendar-week-view>
    <div class="cal-display-sm col-12 ">
      <div class="cal-day-text">
        {{ viewDate | calendarDate:'weekViewColumnHeader':locale }}
      </div>
      <div (swipe)="onSwipe($event)">
        <mwl-calendar-day-view (eventClicked)="handleEvent('Clicked', $event.event)"
          (eventTimesChanged)="eventTimesChanged($event)" [dayEndHour]="22" [dayStartHour]="7" [events]="classes"
          [hourSegmentHeight]="35" [hourSegmentTemplate]="customDayViewHourSegmentTemplateJplanner" [hourSegments]="1"
          [locale]="locale" [refresh]="refresh" [viewDate]="viewDate"></mwl-calendar-day-view>
      </div>
    </div>
  </div>
</div>
<div class="movilMenu col-12 ">
  <mat-tab-group [(selectedIndex)]="verticalMenuIndex" headerPosition="below">
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          search
        </i>
      </ng-template>
      <app-filter></app-filter>
      <br>
      <br>
      <br>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          view_list
        </i>
      </ng-template>
      <app-display-subjects (addSubjetEmit)="addClassSubject($event)" [calendarList]="calendarList">
      </app-display-subjects>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          shopping_cart
        </i>
      </ng-template>
      <app-shopping-cart (removeSubject)="removeClass($event)" [altTitle]='alternativeTitles[currentAlternative]'
        [classes]='alternativeCalendarClasses[currentAlternative]'></app-shopping-cart>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <i class="material-icons">
          today
        </i>
      </ng-template>
      <div class="cal-view-container grid-noGutter">
        <div class="cal-display-sm col-12">
          <div class="cal-day-text">
            {{ viewDate | calendarDate:'weekViewColumnHeader':locale }}
          </div>
          <div class="checkbox-atom-fix-div">
            <label class="checkbox-atom-container checkbox-atom-fix" for="editBlockOption">
              Eliminar/Editar bloqueo semanalmente
              <input [(ngModel)]="editBlockOption" class="hidden-checkbox" id="editBlockOption" name="editBlockOption"
                type="checkbox">
              <span class="checkbox-atom"></span>
            </label>
          </div>
          <div class="cal-schedule-container cal-mobile col-9_xs-12_sm-12_md-12_lg-9 ">
            <div (swipe)="onSwipe($event)">
              <mwl-calendar-day-view (eventClicked)="handleEvent('Clicked', $event.event)"
                (eventTimesChanged)="eventTimesChanged($event)" [dayEndHour]="22" [dayStartHour]="7" [events]="classes"
                [hourSegmentHeight]="35" [hourSegmentTemplate]="customDayViewHourSegmentTemplateJplanner"
                [hourSegments]="1" [locale]="locale" [refresh]="refresh" [viewDate]="viewDate"></mwl-calendar-day-view>
            </div>
          </div>
        </div>
      </div>
      <br>
      <br>
    </mat-tab>
  </mat-tab-group>
</div>